<?xml version="1.0" encoding="utf-8"?>
<s:Scroller xmlns:fx="http://ns.adobe.com/mxml/2009" 
		 xmlns:s="library://ns.adobe.com/flex/spark" 
		 xmlns:mx="library://ns.adobe.com/flex/mx" 
		 xmlns:parsley="http://www.spicefactory.org/parsley"		 
		 horizontalScrollPolicy="off" 
		 xmlns:component1="org.mxhero.console.commons.feature.component.*" 
		 xmlns:component="org.mxhero.console.commons.component.*" 
		 xmlns:FromTo="org.mxhero.console.commons.FromTo.*" 
		 xmlns:cloudtag="org.mxhero.components.cloudtag.*"
		 creationComplete="scroller1_creationCompleteHandler(event)">
	
	<fx:Declarations>
		<parsley:Configure/>
		
		<mx:DateFormatter id="creationDateFormatter" 
						  formatString="DD-MM-YYYY"/>
		
		<s:RadioButtonGroup id="time" />
		
		<mx:SeriesSlide id="slideIn" 
						duration="800" 
						direction="up"/>
		
		<mx:SeriesSlide id="slideOut" 
						duration="800" 
						direction="down"/>
		
		<fx:Array id="bge1">
			<mx:GridLines 
				horizontalChangeCount="1" 
				verticalChangeCount="1"
				gridDirection="both"
				>
				<mx:horizontalStroke>
					<mx:SolidColorStroke weight="1" color="#FFFFFF"/>
				</mx:horizontalStroke>
				<mx:verticalStroke>
					<mx:SolidColorStroke weight="1" color="#FFFFFF"/>
				</mx:verticalStroke>
				<mx:filters>
					<s:DropShadowFilter
						distance="4"
						color="0x666666"
						alpha=".9"/>
				</mx:filters>
			</mx:GridLines>
		</fx:Array>
		
		<fx:Array id="bge2">
			<mx:GridLines 
				horizontalChangeCount="1" 
				verticalChangeCount="1"
				gridDirection="both"
				>
				<mx:horizontalStroke>
					<mx:SolidColorStroke weight="1" color="#FFFFFF"/>
				</mx:horizontalStroke>
				<mx:verticalStroke>
					<mx:SolidColorStroke weight="1" color="#FFFFFF"/>
				</mx:verticalStroke>
				<mx:filters>
					<s:DropShadowFilter
						distance="4"
						color="0x666666"
						alpha=".9"/>
				</mx:filters>
			</mx:GridLines>
		</fx:Array>
	</fx:Declarations>
	
	
	<fx:Script>
		<![CDATA[
			import at.leichtgewicht.cloud.text.DefaultTextRenderer;
			
			import mx.collections.ArrayCollection;
			import mx.events.FlexEvent;
			
			import org.mxhero.console.commons.resources.CommonsProperties;
			import org.mxhero.console.frontend.domain.FeatureRuleDirection;
			import org.mxhero.console.reports.application.resources.CustomProperties;
			import org.mxhero.console.reports.application.resources.ReportsListProperties;
			import org.mxhero.console.reports.application.resources.ThreatsProperties;
			import org.mxhero.console.reports.application.resources.TrafficProperties;
			
			[Inject]
			[Bindable]
			public var model:CustomPM;
			
			protected function dateLabelFunction(item:Object,column:DataGridColumn):String{
				return creationDateFormatter.format(item.date);
			}
			
			[Bindable]
			private var dataDestinationsToAC:ArrayCollection = new ArrayCollection( [
				{ Qty: 15, Email: 'max@backup.com'},
				{ Qty: 18, Email: 'hulk@backup.com'},
				{ Qty: 20, Email: 'thales@backup.com'},
				{ Qty: 21, Email: 'jhon@backup.com'},
				{ Qty: 28, Email: 'smith@backup.com' },
				{ Qty: 32, Email: 'destination@example.com' },
				{ Qty: 54, Email: 'marcelo@mxhero.com' },
				{ Qty: 61, Email: 'alex@inova.net' },
				{ Qty: 65, Email: 'bruno@mxhero.com'},
				{ Qty: 85, Email: 'mmarmol@mxhero.com'}] );
			
			[Bindable]
			private var dataDestinationsFromAC:ArrayCollection = new ArrayCollection( [
				{ Qty: 15, Email: 'max@backup.com'},
				{ Qty: 18, Email: 'hulk@backup.com'},
				{ Qty: 20, Email: 'thales@backup.com'},
				{ Qty: 21, Email: 'jhon@backup.com'},
				{ Qty: 28, Email: 'smith@backup.com' },
				{ Qty: 32, Email: 'destination@example.com' },
				{ Qty: 54, Email: 'marcelo@mxhero.com' },
				{ Qty: 61, Email: 'alex@inova.net' },
				{ Qty: 65, Email: 'bruno@mxhero.com'},
				{ Qty: 85, Email: 'mmarmol@mxhero.com'}] );
			
			[Bindable]
			public var emails:ArrayCollection = new ArrayCollection([
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"dropped",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"delivered",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"rejected",date:new Date()},
				{from:"example@example.com",to:"mmarmol@mxhero.com",subject:"Example Subject",state:"dropped",date:new Date()}
			]);

			protected function fromTo_creationCompleteHandler(event:FlexEvent):void
			{
				CustomPM.refresh=fromTo.refresh;
				fromTo.refresh();
			}
			
			[Bindable]
			public var fromDirection:FeatureRuleDirection=new FeatureRuleDirection();
			[Bindable]
			public var toDirection:FeatureRuleDirection=new FeatureRuleDirection();
			
			protected function scroller1_creationCompleteHandler(event:FlexEvent):void
			{
				this.addEventListener(MouseEvent.MOUSE_WHEEL,handleWheel,true,100);
			}
			
			protected function handleWheel(event:MouseEvent):void{
				event.delta*=4;
			}

		]]>
	</fx:Script>
	
	<s:Group width="100%" height="100%">
		<s:VGroup gap="10" paddingLeft="10" 
				  paddingRight="10" paddingBottom="10" 
				  paddingTop="10" 
				  width="100%" height="100%">
			
			<component:TitleExpanded width="100%"
									 title="{resourceManager.getString(CustomProperties.NAME,CustomProperties.TITLE)}"
									 description="{resourceManager.getString(CustomProperties.NAME,CustomProperties.DESCRIPTION)}"
									 expandedLabel="{resourceManager.getString(CommonsProperties.NAME,CommonsProperties.EXPAND_LABEL)}"
									 reducedLabel="{resourceManager.getString(CommonsProperties.NAME,CommonsProperties.REDUCED_LABEL)}"
									 enableExpanded="false"
									 backLink="{resourceManager.getString(ReportsListProperties.NAME,ReportsListProperties.GOBACK_LABEL)}"
									 backLinkFunction="{model.goBack}"
									 backLinkTooltip="{resourceManager.getString(ReportsListProperties.NAME,ReportsListProperties.GOBACK_TOOLTIP)}"/>
			<mx:Spacer height="0"/>
			
			
			<s:HGroup width="100%" height="100%" gap="20">
				<s:VGroup height="100%" width="60%">
					<FromTo:FromTo fromDirection="{fromDirection}"
								   toDirection="{toDirection}"
								   adminOrder="after"
								   id="fromTo"
								   showAdminPriority="false"
								   creationComplete="fromTo_creationCompleteHandler(event)"/>
					<s:HGroup paddingLeft="80" gap="20">
						<s:RadioButton group="{time}" id="today" label="Today" selected="true"/>
						<s:RadioButton group="{time}" id="range" label="Date Range"/>
						<s:HGroup visible="{range.selected}" verticalAlign="middle">
							<s:Label text="From:"/>
							<mx:DateField id="fromDate" 
										  selectedDate="{new Date()}"/>
							<s:Label text="To:" />
							<mx:DateField id="toDate"
										  selectedDate="{new Date()}"/>
						</s:HGroup>
					</s:HGroup>
					
					<mx:DataGrid width="100%" 
								 borderStyle="solid" 
								 borderColor="0x336699"
								 dataProvider="{emails}"
								 height="100%">
						<mx:columns>
							<mx:DataGridColumn dataField="date" headerText="Date" 
											   labelFunction="dateLabelFunction"/>
							<mx:DataGridColumn dataField="from" headerText="From"/>
							<mx:DataGridColumn dataField="to" headerText="To"/>
							<mx:DataGridColumn dataField="subject" headerText="Subject"/>
							<mx:DataGridColumn  width="36" sortable="false" resizable="false" >
								<mx:itemRenderer>
									<fx:Component>
										<s:MXDataGridItemRenderer width="100%">
											<s:layout>
												<s:VerticalLayout horizontalAlign="center" verticalAlign="middle"/>
											</s:layout>
											<fx:Script>
												<![CDATA[
													import org.mxhero.console.reports.application.resources.ReportsImages;
													
												]]>
											</fx:Script>
											<s:Group>
												<s:layout>
													<s:BasicLayout/>
												</s:layout>
												<component1:GlowButton maxGlow="10.0" 
																	   visible="{data.state=='delivered'}"
																	   source="{ReportsImages.DELIVERED_FROMTO}" 
																	   toolTip="Email was delivered"/>
												<component1:GlowButton maxGlow="10.0" 
																	   visible="{data.state!='delivered'}"
																	   source="{ReportsImages.DROPPED_FROMTO}" 
																	   toolTip="Email was dropped"/>						
												
											</s:Group>
										</s:MXDataGridItemRenderer>
									</fx:Component>
								</mx:itemRenderer>
							</mx:DataGridColumn>
						</mx:columns>
					</mx:DataGrid>
				</s:VGroup>
				<s:VGroup height="100%" width="40%" >
					<s:VGroup width="100%" height="50%" gap="20">
						<s:Label text="Top Ten Senders" 
								 fontWeight="bold" fontSize="16"
								 color="#FFFFFF"
								 textDecoration="underline"/>
						<s:HGroup width="100%" height="100%" horizontalAlign="center" verticalAlign="top">
							<mx:BarChart id="linechartFrom" color="0x323232" 
										 height="100%" 
										 width="100%"
										 minHeight="240"
										 showDataTips="true" 
										 styleName="myChart"
										 dataProvider="{dataDestinationsFromAC}"
										 axisTitleStyleName="axisTitles"
										 backgroundElements="{bge1}">
								
								<mx:filters>
									<s:DropShadowFilter
										distance="4"
										color="0x666666"
										alpha=".9"/>
								</mx:filters>
								
								<mx:horizontalAxis>
									
									<mx:LinearAxis id="qtyAxisFrom" 
												   displayName="Amount"  
												   title="Amount" 
												   />
								</mx:horizontalAxis>
								
								<mx:verticalAxis>
									
									<mx:CategoryAxis
										id="emailAxisFrom"
										categoryField="Email"
										displayName="Email"
										title="Email"
										/>
								</mx:verticalAxis>
								
								<mx:verticalAxisRenderers>
									<mx:AxisRenderer 
										axis="{emailAxisFrom}" 
										color="#FFFFFF" 
										fontSize="14"
										/>
								</mx:verticalAxisRenderers>
								
								<mx:horizontalAxisRenderers>
									<mx:AxisRenderer 
										axis="{qtyAxisFrom}" 
										color="#FFFFFF" 
										fontSize="14"
										/>	  
									
									
								</mx:horizontalAxisRenderers>
								
								<mx:fill>
									<mx:SolidColor color="0x66CCFF" alpha="0.0"/>
								</mx:fill>
								
								<mx:series>
									<mx:BarSeries xField="Qty" 
												  yField="Email" 
												  showDataEffect="{slideIn}" 
												  hideDataEffect="{slideOut}"
												  id="cserieFrom"
												  buttonMode="true"
												  >
										<mx:stroke>
											<s:SolidColorStroke color="#FFFFFF" caps="round" />
										</mx:stroke>
										<mx:fills>
											<mx:SolidColor color="0xFF99DD" alpha=".6"/>
											<mx:SolidColor color="0xFF80D4" alpha=".6"/>
											<mx:SolidColor color="0xFF66CC" alpha=".6"/>
											<mx:SolidColor color="0xFF4DC3" alpha=".6"/>
											<mx:SolidColor color="0xFF33BB" alpha=".6"/>
											<mx:SolidColor color="0xFF1AB3" alpha=".6"/>
											<mx:SolidColor color="0xFF00AA" alpha=".6"/>
											<mx:SolidColor color="0xE60099" alpha=".6"/>
											<mx:SolidColor color="0xCC0088" alpha=".6"/>
											<mx:SolidColor color="0xB30077" alpha=".6"/>
										</mx:fills>
										<mx:filters>
											<s:DropShadowFilter
												distance="8"
												color="0x666666"
												alpha=".8"/>
										</mx:filters>
									</mx:BarSeries>
								</mx:series>
								
							</mx:BarChart>			
						</s:HGroup>
					</s:VGroup>
					<s:VGroup width="100%" height="50%" gap="20">
						<s:Label text="Top Ten Recipients" 
								 fontWeight="bold" fontSize="16"
								 color="#FFFFFF"
								 textDecoration="underline"/>
						<s:HGroup width="100%" height="100%" horizontalAlign="center" verticalAlign="top">
							<mx:BarChart id="linechartTo" color="0x323232" 
										 height="100%" 
										 width="100%"
										 minHeight="240"
										 showDataTips="true" 
										 styleName="myChart"
										 dataProvider="{dataDestinationsToAC}"
										 axisTitleStyleName="axisTitles"
										 backgroundElements="{bge2}">
								
								<mx:filters>
									<s:DropShadowFilter
										distance="4"
										color="0x666666"
										alpha=".9"/>
								</mx:filters>
								
								<mx:horizontalAxis>
									
									<mx:LinearAxis id="qtyAxisTo" 
												   displayName="Amount"  
												   title="Amount" 
												   />
								</mx:horizontalAxis>
								
								<mx:verticalAxis>
									
									<mx:CategoryAxis
										id="emailAxisTo"
										categoryField="Email"
										displayName="Email"
										title="Email"
										/>
								</mx:verticalAxis>
								
								<mx:verticalAxisRenderers>
									<mx:AxisRenderer 
										axis="{emailAxisTo}" 
										color="#FFFFFF" 
										fontSize="14"
										/>
								</mx:verticalAxisRenderers>
								
								<mx:horizontalAxisRenderers>
									<mx:AxisRenderer 
										axis="{qtyAxisTo}" 
										color="#FFFFFF" 
										fontSize="14"
										/>	  
									
									
								</mx:horizontalAxisRenderers>
								
								<mx:fill>
									<mx:SolidColor color="0x66CCFF" alpha="0.0"/>
								</mx:fill>
								
								<mx:series>
									<mx:BarSeries xField="Qty" 
												  yField="Email" 
												  showDataEffect="{slideIn}" 
												  hideDataEffect="{slideOut}"
												  id="cserieTo"
												  buttonMode="true"
												  >
										<mx:stroke>
											<s:SolidColorStroke color="#FFFFFF" caps="round" />
										</mx:stroke>
										<mx:fills>
											<mx:SolidColor color="0xCCD9FF" alpha=".6"/>
											<mx:SolidColor color="0xB3C6FF" alpha=".6"/>
											<mx:SolidColor color="0x99B3FF" alpha=".6"/>
											<mx:SolidColor color="0x809FFF" alpha=".6"/>
											<mx:SolidColor color="0x668CFF" alpha=".6"/>
											<mx:SolidColor color="0x4D79FF" alpha=".6"/>
											<mx:SolidColor color="0x3366FF" alpha=".6"/>
											<mx:SolidColor color="0x1A53FF" alpha=".6"/>
											<mx:SolidColor color="0x0040FF" alpha=".6"/>
											<mx:SolidColor color="0x0039E6" alpha=".6"/>
										</mx:fills>
										<mx:filters>
											<s:DropShadowFilter
												distance="8"
												color="0x666666"
												alpha=".8"/>
										</mx:filters>
									</mx:BarSeries>
								</mx:series>
								
							</mx:BarChart>			
						</s:HGroup>
					</s:VGroup>
				</s:VGroup>
				
			</s:HGroup>
		</s:VGroup>
	</s:Group>

</s:Scroller>